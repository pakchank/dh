<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>prerequisite – book</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">book</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./1_prerequisite.html" aria-current="page"> 
<span class="menu-text">강의 사전 준비</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#appendix-install" id="toc-appendix-install" class="nav-link active" data-scroll-target="#appendix-install">강의 사전 준비</a>
  <ul class="collapse">
  <li><a href="#체크리스트-강의-수강-전-반드시-완료" id="toc-체크리스트-강의-수강-전-반드시-완료" class="nav-link" data-scroll-target="#체크리스트-강의-수강-전-반드시-완료">체크리스트 (강의 수강 전 <strong>반드시</strong> 완료)</a></li>
  <li><a href="#r-설치" id="toc-r-설치" class="nav-link" data-scroll-target="#r-설치">R 설치</a></li>
  <li><a href="#rstudio-설치" id="toc-rstudio-설치" class="nav-link" data-scroll-target="#rstudio-설치">Rstudio 설치</a></li>
  <li><a href="#r과-rstudio-처음-이용하기" id="toc-r과-rstudio-처음-이용하기" class="nav-link" data-scroll-target="#r과-rstudio-처음-이용하기">R과 Rstudio 처음 이용하기</a></li>
  <li><a href="#패키지-설치" id="toc-패키지-설치" class="nav-link" data-scroll-target="#패키지-설치">패키지 설치</a>
  <ul class="collapse">
  <li><a href="#패키지-사용시-주의사항-설치-로드" id="toc-패키지-사용시-주의사항-설치-로드" class="nav-link" data-scroll-target="#패키지-사용시-주의사항-설치-로드">패키지 사용시 주의사항: 설치? 로드?</a></li>
  </ul></li>
  <li><a href="#konlp-설치" id="toc-konlp-설치" class="nav-link" data-scroll-target="#konlp-설치">KoNLP 설치</a></li>
  <li><a href="#ner-nlp-받기" id="toc-ner-nlp-받기" class="nav-link" data-scroll-target="#ner-nlp-받기">NER NLP 받기</a></li>
  <li><a href="#koddas-db-api-받기" id="toc-koddas-db-api-받기" class="nav-link" data-scroll-target="#koddas-db-api-받기">KODDAS DB API 받기</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="appendix-install" class="level1">
<h1>강의 사전 준비</h1>
<p>본 튜토리얼에서는 강의를 듣기 앞서 필수적으로 이루어져야 하는 사전 준비작업들을 설명합니다. 수강자분들께서는 수강 전에 <strong>반드시</strong> 여기서 설명된 준비 작업을 수행하시고, 강의에 참여해주시기 바랍니다. 한정된 강의 시간과 수강생의 수를 고려할 때 강의 중 아래 준비작업에 도움을 드리기는 어렵다는 점 기억해 주시기 바랍니다. <code>R</code>을 이용해 본 경험이 있는 분들은 아래 체크리스트를 살펴 보시고 아직 이루어지지 않은 부분만 실행하시면 되겠습니다.</p>
<section id="체크리스트-강의-수강-전-반드시-완료" class="level3">
<h3 class="anchored" data-anchor-id="체크리스트-강의-수강-전-반드시-완료">체크리스트 (강의 수강 전 <strong>반드시</strong> 완료)</h3>
<ul>
<li>R 설치</li>
<li>Rtools 설치 (윈도우즈 이용자만)</li>
<li>Rstudio 설치</li>
<li>tidyverse 등 패키지 설치</li>
<li>KoNLP 설치</li>
<li>ETRI AI API 받기</li>
<li>KODDAS API 작동 체크</li>
<li><a href="https://forms.gle/f836zwwofUTnk5tX8">사전 설문조사 참여</a></li>
</ul>
<p>만약, 위의 사전 작업을 수행하시는 중에 해결이 안 되는 부분이 있다면, 다음 오픈채팅방을 이용해서 질문해주시기 바랍니다. 다만, 튜토리얼을 상세히 읽고, 혼자 최대한 시도를 해 보고 질문을 해 주실 것을 부탁드립니다. 오픈채팅 방은 강의 중에도 사용될 예정이나, 모두 가입해주시면 감사하겠습니다.</p>
<p><a href="https://open.kakao.com/o/gHSo3K8g"><strong>오픈 카톡</strong></a></p>
<p>또한, 당일 원활한 워크샵 진행을 위해 사전 설문조사를 꼭 작성해 주시기 바랍니다. 참여자 분들이 이미 익숙한 내용에 대한 반복을 피하고, 가능한 모두에게 유용한 내용의 워크샵이 될 수 있도록 준비하기 위함입니다.</p>
<p><a href="https://forms.gle/f836zwwofUTnk5tX8"><strong>사전 설문조사</strong></a></p>
<p>가장 먼저 본 워크샵의 작업 환경에 해당하는 <code>R</code>과 <code>Rstudio</code>의 설치법을 설명합니다. 실제로 이용하는 언어는 R이지만, R 그 자체는 편리한 사용성을 제공하지 못합니다. 하지만, <code>R</code>이 이미 설치되어 있다면, <code>Rstudio</code>를 통해서 훨씬 편하고 세련된 환경에서 코딩을 할 수 있을 뿐만 아니라 <code>R</code> 자체로는 구현할 수 없는 중요한 추가적인 기능들–홈페이지 제작, 인터렉티브 시각화 등–을 활욯할 수 있게 됩니다. 따라서, 본 교재의 학습을 위해서는 <code>R</code>과 <code>Rstudio</code> 모두를 설치해야 합니다.</p>
</section>
<section id="r-설치" class="level2">
<h2 class="anchored" data-anchor-id="r-설치">R 설치</h2>
<p>R을 설치하기 위해서는 <a href="https://cran.yu.ac.kr/">R다운로드 페이지</a>로 이동해야 합니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/download.png" class="img-fluid figure-img"></p>
<figcaption>R 다운로드 페이지</figcaption>
</figure>
</div>
<p>여기에서 사용하는 운영체제에 맞추어 링크를 선택합니다. 여기서는 윈도우즈 사용환경을 가정하고 ’<a href="https://cran.yu.ac.kr/bin/windows/">Download R for Windows</a>’를 클릭합니다 (물론 맥 이용자나 리눅스 이용자라면 다른 옵션을 선택하시면 됩니다). 그러면 다음과 같은 화면이 나타날 것입니다.</p>
<p><img src="img/windows.png" class="img-fluid" alt="윈도우즈 사용자를 위한 R 다운로드"> 윈도우즈 이용자들은 두 가지를 설치해야 합니다. 하나는 ’base’라고 표시되어 있는 R프로그램 그 자체입니다. 해당 하이퍼링크를 클릭하면 이동하는 페이지에 ’Download R-4.4.2 for Windows’라고 표시된 하이퍼링크가 있을 것입니다 (4.4.2이라는 버전을 나타내는 숫자는 최신 업데이트에 따라 달라질 수 있습니다). 이를 클릭하면 다음 설치 파일이 다운로드 됩니다.</p>
<p>두번째로 다운로드 받을 파일은 위의 화면 캡춰에서 <code>Rtools</code>라고 표시되어 있는 R의 확장 프로그램 입니다. 이 역시 R의 다양한 기능을 활용하기 위해서 반드시 필요합니다. 해당 링크를 클릭하여 앞서 다운 받은 R 버전에 맞는 RTools를 다운받습니다. 예컨대 앞서 R 4.4.0버전을 다운 받았으니, ’RTools 4.4’을 다운받는 것이지요.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>윈도우즈 사용자는 반드시 <code>R</code>과 <code>RTools</code> 모두를 설치해야 합니다. <code>RTools</code>를 설치하지 않은 경우, 뒤에서 설명할 여러 패키지 설치 과정이 작동하지 않을 수 있습니다.</p>
<p>단, <strong>맥 사용자는 R만 설치하면 됩니다.</strong></p>
</div>
</div>
<p>이제 두 설치파일을 다운로드 받은 순서대로 더블클릭하여 설치를 완료하면 됩니다. 여기서도, 한 가지 주의사항이 있습니다. R은 오픈소스 언어이기 때문에, 상업 프로그램처럼 다양한 언어를 부드럽게 처리하지못하는 경우가 있습니다. 관련해서 가장 많은 에러를 양산하는 문제 중 하나가 R이 설치된 경로상에 한글이 섞여 있는 경우 입니다. 예컨대, 윈도우즈의 이용자 이름이 자신의 이름으로 되어 있다면, 설치경로가 에러를 만들어 내는 경우가 많습니다. 예컨대, “C:.2”과 같은 주소는 한글이 포함되어 좋지 않다는 이야기 입니다. “C:Files.2”과 같은 설치 경로는 한글이 포함되어 있지 않으므로, 문제가 없습니다. 따라서, 윈도우즈 이용자 이름에 알파벳이 아닌 다른 문자가 섞여 있다면, <code>R</code> 설치시 설정하는 모든 경로를 이용자 이름이 섞이지 않도록 적절하게 수정해 주는 것이 좋습니다.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>R</code> 설치 경로는 알파벳만으로 이루어지도록 주의하세요.</p>
</div>
</div>
</section>
<section id="rstudio-설치" class="level2">
<h2 class="anchored" data-anchor-id="rstudio-설치">Rstudio 설치</h2>
<p>Rstudio는 오픈소스 프로젝트가 아니라 사기업인 Posit에 의해 관리되기 때문에 다운로드 및 설치가 더욱 쉽습니다. <a href="https://posit.co/download/rstudio-desktop/">다음 링크</a>를 따라가서, 각자의 운영체제에 맞는 설치파일을 다운 받은 후 실행해 주면 됩니다. 다만, <code>Rstuio</code>의 설치는 <code>R</code> 설치가 모두 완료된 다음 해 주는 것이 불필요한 에러를 방지할 수 있습니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/rstudio_install.png" class="img-fluid figure-img"></p>
<figcaption>Rstudio 다운로드 페이지</figcaption>
</figure>
</div>
</section>
<section id="r과-rstudio-처음-이용하기" class="level2">
<h2 class="anchored" data-anchor-id="r과-rstudio-처음-이용하기">R과 Rstudio 처음 이용하기</h2>
<p>먼저, R은 윈도우 시작 버튼을 눌러 실행할 수 있습니다. 시작 화면에서 전체 애플리케이션을 열면, 여러분의 컴퓨터에 설치된R은 보통 다음과 같이 나타납니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/R_start.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>윈도우즈에서 R 실행하기</figcaption>
</figure>
</div>
<p>제 경우에는 여러 버전의 R을 설치하다보니 여러 가지의 R이 보이는데요, 그 중에서 버전이 가장 높은 것을 선택하시면 됩니다. i386과 x64는 여러분이 사용하는 컴퓨터의 환경과 관련이 있는데, 대부분의 요즘 컴퓨터는 x64라고 생각하시면 됩니다. 따라서 위의 경우에는 <code>R x64 4.1.3</code>을 선택하면 되겠네요. 이를 실행하면 다음과 같은 화면이 나타나게 됩니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/R_gui.png" class="img-fluid figure-img"></p>
<figcaption>R 화면</figcaption>
</figure>
</div>
<p>화면에 가장 크게 보이는 하얀 창이 바로 R의 핵심인 콘솔(Console) 입니다. 여기에 이러저러한 명령을 하고 엔터를 치면 R은 해당 명령을 수행한 결과를 표시해 줍니다. R을 사용하는 가장 단순한 방법은 계산기 처럼 활용하는 것입니다. 예컨대 2+1이라는 연산을 한다고 해 볼까요? 그 때는 가장 단순하게 다음과 2+1이라고 콘솔에 쓰시고 엔터키를 치면 됩니다. 그러면 다음과 같은 결과를 볼 것입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>물론, 여러분이 나중에 작성하게될 코드는 이보다 복잡할 것입니다. 그렇다면 코드를 한줄 쓰고 실행하는 이런 단순한 방식은 아무래도 불편할 것입니다. 따라서, 대부분의 이용자들은 위와 같은 화면에서 <code>R</code>을 사용하지 않습니다. 대신 <code>Rstudio</code>라는 환경을 사용하지요.</p>
<p>여러분 컴퓨터에 설치된 Rstudio를 사용하는 가장 간단한 방법은 윈도우즈 화면 하단 시작 버튼 옆의 검색창에 ’Rstudio’라고 검색해 보는 것입니다. <code>Rstudio</code>가 올바르게 설치되어 있다면, 다음과 유사한 화면을 보게 될 것입니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/rstudio_start.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Rstudio 시작</figcaption>
</figure>
</div>
<p>이제 Rstudio를 선택해서 프로그램을 실행시키면 다음과 같은 화면이 나타납니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/rstudio.png" class="img-fluid figure-img"></p>
<figcaption>Rstudio 첫 화면</figcaption>
</figure>
</div>
<p>바탕화면은 초기설정에 따라 위와 같이 어두운 색이기도, 밝은 색이기도 합니다. <code>Rstudio</code>는 <code>R</code>을 편리하게 사용할 수 있도록 도와줄 뿐만 아니라, <code>R</code>의 더 많은 기능을 이끌어내기 위해 만들어낸 인터페이스라고 생각하시면 됩니다. 전문적인 용어로는 통합개발환경(IDE)라고 하지요. 비유하자면, <code>R</code>가 엔진이라면, <code>Rstudio</code>는 여러분이 직접 운전하는 자동차와 같은 관계라고 생각하시면 되겠습니다. 엔진을 이용해 직접 가능한 탈것을 만드는 사람은 극히 제한적이듯, 대부분의 사람들은 <code>Rstudio</code>를 사용하지, <code>R</code>을 직접 사용하지 않습니다. 따라서, 여러분들 역시 앞으로 Rstudio만을 사용하게 될 것입니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/r_rstudio.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>R과 Rstudio 간의 관계</figcaption>
</figure>
</div>
<p><code>Rstudio</code>의 초기 화면에 보이는 가장 큰 공간은 <code>R</code>의 콘솔 입니다. 앞서 <code>R</code>의 기본 인터페이스에서 본 콘솔과 같은 콘솔이지요. 따라서 앞서 했던 것처럼 <code>2+1</code>라고 치고 엔터를 치면 아까와 같은 결과가 나올 것입니다.</p>
</section>
<section id="패키지-설치" class="level2">
<h2 class="anchored" data-anchor-id="패키지-설치">패키지 설치</h2>
<p><code>R</code>뿐만 아니라, 많은 다른 언어에서 ’패키지’라고 하는 것은 쉽게 말하자면 유용한 함수들의 묶음을 의미합니다. 기본 <code>R</code>을 설계한 사람들이 <code>R</code>에 내장해두지는 않았지만, 특정 목적을 위해서는 유용함 도구들이 묶여서 ’패키지’로 제공된다고 생각하면 되겠습니다. 비유하자면, 여러분들이 매일 사용하는 ’카카오톡’이 <code>R</code>이라고 해 보죠. 카카오톡 안에는 기본적인 채팅 기능 안에도 수많은 다른 기능들이 있지요? 선물을 주고 받을 수도 있고, 음식을 주문할 수도 있고, 쇼핑을 할 수도 있습니다. 물론 모든 이용자들이 이 기능들을 모두 사용하지는 않지요. 하지만, 어떤 사람들은 자주 사용합니다. 이러한 세부 기능에 해당 하는 일종의 카카오톡 안의 ’미니 프로그램’을 <code>R</code>에서는 패키지라고 부른다고 생각하면 되겠습니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/kakaotalk_miniprogram.jpg" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>카카오 미니프로그램</figcaption>
</figure>
</div>
<p><code>R</code>에서 패키지를 부르는 방법은 다음과 같습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>library()</code>는 괄호가 있으니, 패키지를 부르는 ’함수’일 것이고, 괄호 안에는 부르고 싶은 패키지의 이름을 <strong>따옴표 없이</strong> 쓰면 됩니다. 여기서는 <code>R</code>을 설치할 때 같이 설치되는 <code>stats</code>라는 패키지를 불렀습니다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/package.png" class="img-fluid figure-img"></p>
<figcaption>패키지 종류</figcaption>
</figure>
</div>
<p>그런데 <code>R</code>이 설치될 때 모든 패키지가 함께 설치되는 것은 아닙니다. 사실 그렇지 않은 패키지가 훨씬 많지요. 심지어 패키지는 여러분도 만들 수 있습니다. 그렇게 개인이 여러 목적으로 만든 비공식 패키지까지 포함한다면, 세상에는 무한히 많은 <code>R</code> 패키지들이 있습니다. 하지만, 우리가 자주 사용하게될 패키지는 <code>R</code>개발진들의 관리 감독 아래 있는 ‘공식’ 패키지들입니다. 공식 패키지이지만, <code>R</code>과 함께 설치되지 않는 패키지를 설치하기 위해서는 다음과 같은 함수를 실행시키면 됩니다 (여기서는 따옴표가 필요합니다!).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>물론, 설치만 한다고 해서 바로 이 패키지를 사용할 수 있는 것은 아닙니다. 아까 <code>stats</code> 패키지의 예에서처럼, <code>tidyverse</code> 패키지도 다음과 같이 불러주어야 합니다.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>패키지 이름을 따옴표로 감싸지 않으면, 패키지가 설치되지 않습니다.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이 함수를 실행시키면 <code>tidyverse</code>라는 패키지를 사용할 준비가 된 것입니다.</p>
<p>이 강의에서는 <code>tidyverse</code> 이외에도 다른 여러 패키지들을 사용할 예정입니다. 이 패키지들을 한 번에 설치하기 위해 다음과 같은 명령을 콘솔에서 실행시켜 주세요.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="st">"purrr"</span>, <span class="st">"tidytext"</span>, <span class="st">"tidygraph"</span>, <span class="st">"igraph"</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"networkD3"</span>, <span class="st">"widyr"</span>, <span class="st">"ggraph"</span>, <span class="st">"readxl"</span>, <span class="st">"httr"</span>, <span class="st">"glue"</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"jsonlite"</span>, <span class="st">"shiny"</span>, <span class="st">"showtext"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="패키지-사용시-주의사항-설치-로드" class="level3">
<h3 class="anchored" data-anchor-id="패키지-사용시-주의사항-설치-로드">패키지 사용시 주의사항: 설치? 로드?</h3>
<p>방금 <code>tidyverse</code> 패키지를 설치하고 불러왔는데요, 여기서 패키지를 ’설치’한다는 것과 ’불러온다’는 것의 의미에 대해 잠깐 생각해볼 필요가 있습니다.</p>
<p>여러분이 일상적으로 윈도우 또는 맥OS 상에서 어떤 소프트웨어를 ‘설치’하면 그것은 어디에 저장되었다는 것을 의미하나요? 당연히 HDD, SSD와 같은 ’저장장치’ 입니다. 그래야, 컴퓨터를 껐다 다시 키더라도, 다시 ’설치’할 필요가 없을테니까요. <code>tidyverse</code> 패키지를 설치했다는 것도 비슷한 의미입니다. 설치한 패키지는 저장장치 어디엔가 저장되어 있습니다.</p>
<blockquote class="blockquote">
<p><em>따라서, 설치는 한 번 했다면 다시 할 필요가 없습니다.</em></p>
</blockquote>
<p>그런데 여러분 설치한 소프트웨어가 항상 켜져있나요? 물론 아닙니다. 그 소프트웨어를 실행시켜야지요. 실행시킨다는 것은 뭘까요? 여러 의미가 있지만, 가장 기본적으로는 저장장치에 설치되어 있는 해당 프로그램을 컴퓨터 메모리 상에 ’불러온다’는 것입니다. 가끔 여러분들 너무 많은 소프트웨어를 동시에 열어두면 컴퓨터가 느려져서 몇몇 사용하지 않는 프로그램을 꺼야했던 경험이 있을 것입니다. 프로그램을 껐다는 것은 반대로 메모리에서 지운다는 것을 의미하겠지요. 따라서 메모리에 여유 공간을 조금 확보하려고 프로그램을 끄는 것입니다. 이렇게 프로그램을 켠다는 것은 <code>R</code> 패키지로 치면 패키지를 로드하는 과정과 유사합니다.</p>
<p>아까의 예에서처럼 <code>library(tidyverse)</code>라는 함수를 실행시키면, 저장장치에 저장되어 있던 <code>tidyverse</code> 패키지가 메모리로 불러와집니다. 그런데 메모리는 어떤 특성을 가지고 있었나요? 컴퓨터를 꺼도, 해당 정보에 할당된 이름이 사라져도, 메모리에서 언제든 사라질 수 있습니다. 이것은 무슨 이야기일까요? 여러분들이 <code>Rstudio</code>를 끄는 순간, 또는 <code>Rstudio</code> 안에서 다른 프로젝트로 이동하는 순간, 불러왔던 패키지는 메모리에 존재하지 않는 것이 됩니다. 그러니,</p>
<blockquote class="blockquote">
<p>패키지를 불러오는 것은 <code>Rstudio</code>를 새로 켤 때마다, 또는 새로운 프로젝트로 이동할 때마다, 매번 다시 해야 합니다!</p>
</blockquote>
</section>
</section>
<section id="konlp-설치" class="level2">
<h2 class="anchored" data-anchor-id="konlp-설치">KoNLP 설치</h2>
<p><code>KoNLP</code>는 한국어 자연어 처리를 <code>R</code> 패키지 입니다. 사실, KoNLP는 <code>R</code>이 아니라 <code>JAVA</code>라는 다른 언어에서 작동하는 패키지이고, <code>R</code>의 <code>KoNLP</code> 패키지는 <code>JAVA</code> <code>KoNLP</code>를 작동하기 위한 리모컨과 같은 역할을 합니다. 다른 말로는 ’wrapper’라고 하지요. 이 때문에, <code>R</code>에서 <code>KoNLP</code>를 작동시키기 위해서는 <code>JAVA</code> 언어를 함께 설치해야 합니다. 또 하나 복잡한 문제는 <code>KoNLP</code>가 <code>R</code>의 공식 패키지가 아니라는 것입니다. 이러한 이유로 인해서 <code>KoNLP</code>의 설치 방식은 다소 복잡합니다. 그 중 가장 간단하다고 생각하는 설치 과정은 다음과 같습니다.</p>
<ol type="1">
<li><code>multilinguer' 패키지를 이용한</code>JAVA` 설치.</li>
<li><code>KoNLP</code> 패키지 수동 설치.</li>
<li><code>Cli</code> 패키지 수동 설치.</li>
<li><code>scala-library-2.11.8.jar</code> 파일 다운로드.</li>
</ol>
<p>자세한 설치 과정은 다른 분들이 이미 잘 작성해 둔 블로그 포스트들을 참조해주시기 바랍니다.</p>
<p>JAVA 설치는 다음 블로그를 참조해주세요.</p>
<p>https://e-datanews.tistory.com/155</p>
<p>나머지 2,3,4 단계 과정은 다음 포스트를 참조해주세요.</p>
<p>https://m.blog.naver.com/meta_com/223021590616</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>윈도우즈 이용자들은 앞서 설치하기로 한 <code>RTools</code>를 설치하지 않았다면, 위의 과정은 잘 진행되지 않습니다.</p>
<p>많은 분들 컴퓨터에 이미 <code>JAVA</code>가 설치되어 있을 가능성이 높지만, 첫번째 블로그 포스트에서 안내하는대로, <code>multilinguer</code> 패키지의 <code>install_jdk()</code> 함수를 실행시켜주는 편이 오류의 가능성을 줄일 수 있습니다.</p>
</div>
</div>
<p>모든 설치가 끝나면, 다음 명령어를 차례로 콘솔에서 실행 해 보세요.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(KoNLP)   <span class="co"># 패키지 이름에서 'o'는 소문자 입니다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Checking user defined dictionary!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">SimplePos22</span>(<span class="st">"KoNLP 설치를 성공적으로 완료하였습니다."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$KoNLP
[1] "KoNLP/F"

$설치를
[1] "설치/NC+를/JC"

$성공적으로
[1] "성공적/NC+으로/JC"

$완료하였습니다
[1] "완료/NC+하/XS+었/EP+습니다/EF"

$.
[1] "./SF"</code></pre>
</div>
</div>
<p>이 코드가 에러 없이 실행되면, <code>KoNLP</code>가 잘 설치된 것입니다.</p>
</section>
<section id="ner-nlp-받기" class="level2">
<h2 class="anchored" data-anchor-id="ner-nlp-받기">NER NLP 받기</h2>
<p>본 강의에서는 한국전자통신연구원에서 개발한 ‘개체명 인식’ 분류기를 이용할 것입니다. 이는 트레이닝이 완료된 기계학습 모형이지만, 우리는 해당 기계학습 모형을 직접 각자의 컴퓨터에 로드하는 것이 아니라, 인터넷으로 우리가 가진 자연어 데이터를 ETRI로 전송하여 분류한 결과를 전송 받는 방식으로 작업할 예정입니다.</p>
<p>이를 위해서는 ETRI로부터 AI Open AI Key를 발급받아야 합니다. 이를 위해서는 다음 웹사이트를 방문하세요.</p>
<p>https://aiopen.etri.re.kr/keyMain</p>
<p>발급 신청이 완료된 후, <a href="https://aiopen.etri.re.kr/keyCheck">‘API Key 확인’</a> 메뉴에서 발급이 확인되면 API를 사용할 준비가 된 것입니다. API Key는 긴 문자열 형태인데, 이는 강의 전에 미리 복사해 사용할 수 있도록 준비해두기 바랍니다.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>미리 발급 받는 API 인증키를 워크샵에서 사용할 수 있도록 복사해 두세요.</p>
</div>
</div>
</section>
<section id="koddas-db-api-받기" class="level2">
<h2 class="anchored" data-anchor-id="koddas-db-api-받기">KODDAS DB API 받기</h2>
<p>강의 시간에 사용할 코리아 디아스포라 인터뷰 데이터 역시 경북대 사회과학연구원에서 제공하는 API를 통해서 다운 받아 사용할 에정입니다. 현재 API 키 발급 시스템이 개발 중에 있기 때문에, 수업용으로 미리 발급해둔 공동 키를 사용하겠습니다.</p>
<p>다음 명령어를 <code>R</code> 콘솔에서 차례로 실행시켜보았을 때 에러 없이 아래와 같은 결과가 얻어진다면, 준비가 완료된 것입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="at">url=</span><span class="st">"https://koddas.knu.ac.kr/api/v1/statement"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">query=</span><span class="fu">list</span>(<span class="at">key=</span><span class="st">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImFwaXVzZXIiLCJpYXQiOjE3MzUyOTc0MDIsImV4cCI6MTc2NjgzMzQwMn0.q9upgIiYB6haOzc-aUUlwXk5qKvydFZtmDVzXarI1VI"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">page=</span><span class="dv">1</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">limit=</span><span class="st">"5"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">bookNumber=</span><span class="st">"28"</span>))</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>dtString <span class="ot">&lt;-</span> <span class="fu">content</span>(res, <span class="at">type=</span><span class="st">"text"</span>, <span class="at">encoding=</span><span class="st">"utf-8"</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">fromJSON</span>(dtString)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id bookId categoryId page type
1 27743     28         NA    0 TEXT
2 27744     28         NA    0 TEXT
3 27745     28         NA    0 TEXT
4 27746     28         NA    0 TEXT
5 27747     28         NA    2 TEXT
                                        content
1              카타리베 활동가 배동록의 생애사 
2                            박신규·이토히로코
3     경북대학교 사회과학연구원 인문사회연구소 
4 도서출판 책과세계 재외한인 구술생애사 총서 28
5                                        서 문 </code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>